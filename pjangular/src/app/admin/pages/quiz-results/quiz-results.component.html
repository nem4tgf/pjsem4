<nz-card nzTitle="üìä Qu·∫£n l√Ω K·∫øt qu·∫£ B√†i ki·ªÉm tra" class="quiz-results-card">
  <!-- Form nh·∫≠p k·∫øt qu·∫£ -->
  <form nz-form [formGroup]="resultForm" *ngIf="isAdmin" class="quiz-form">
    <div nz-row nzGutter="16">
      <div nz-col nzSpan="8">
        <nz-form-item class="form-item">
          <nz-form-label nzRequired>
            <i nz-icon nzType="user" nzTheme="fill" class="icon-user"></i> Ng∆∞·ªùi d√πng
          </nz-form-label>
          <nz-form-control [nzErrorTip]="resultForm.get('userId')?.touched && resultForm.get('userId')?.hasError('required') ? 'B·∫Øt bu·ªôc' : undefined">
            <nz-select
              formControlName="userId"
              nzPlaceHolder="Ch·ªçn ng∆∞·ªùi d√πng"
              nzShowSearch
              class="custom-select"
            >
              <nz-option *ngFor="let user of users" [nzValue]="user.userId" [nzLabel]="user.username"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </div>

      <div nz-col nzSpan="8">
        <nz-form-item class="form-item">
          <nz-form-label nzRequired>
            <i nz-icon nzType="file-done" nzTheme="fill" class="icon-quiz"></i> B√†i ki·ªÉm tra
          </nz-form-label>
          <nz-form-control [nzErrorTip]="resultForm.get('quizId')?.touched && resultForm.get('quizId')?.hasError('required') ? 'B·∫Øt bu·ªôc' : undefined">
            <nz-select formControlName="quizId" nzPlaceHolder="Ch·ªçn b√†i ki·ªÉm tra" nzShowSearch class="custom-select">
              <nz-option *ngFor="let quiz of quizzes" [nzValue]="quiz.quizId" [nzLabel]="quiz.title"></nz-option>
            </nz-select>
          </nz-form-control>
        </nz-form-item>
      </div>

      <div nz-col nzSpan="6">
        <nz-form-item class="form-item">
          <nz-form-label nzRequired>
            <i nz-icon nzType="number" nzTheme="fill" class="icon-score"></i> ƒêi·ªÉm s·ªë
          </nz-form-label>
          <nz-form-control [nzErrorTip]="resultForm.get('score')?.touched ? (resultForm.get('score')?.hasError('required') ? 'B·∫Øt bu·ªôc' : resultForm.get('score')?.hasError('min') || resultForm.get('score')?.hasError('max') ? 'ƒêi·ªÉm ph·∫£i t·ª´ 0 - 100' : undefined) : undefined">
            <nz-input-number formControlName="score" [nzMin]="0" [nzMax]="100" nzPlaceHolder="Nh·∫≠p ƒëi·ªÉm"></nz-input-number>
          </nz-form-control>
        </nz-form-item>
      </div>

      <div nz-col nzSpan="2" class="button-col">
        <button nz-button nzType="primary" (click)="saveResult()" class="save-button">
          <i nz-icon nzType="save" nzTheme="fill" class="icon-save"></i> L∆∞u
        </button>
      </div>
    </div>
  </form>

  <nz-divider *ngIf="isAdmin"></nz-divider>

  <!-- B·∫£ng k·∫øt qu·∫£ -->
  <nz-table #basicTable [nzData]="results" [nzLoading]="!results.length" *ngIf="isAdmin" class="quiz-results-table">
    <thead>
      <tr>
        <th><i nz-icon nzType="user" nzTheme="fill" class="icon-user"></i> Ng∆∞·ªùi d√πng</th>
        <th><i nz-icon nzType="file-done" nzTheme="fill" class="icon-quiz"></i> B√†i ki·ªÉm tra</th>
        <th><i nz-icon nzType="number" nzTheme="fill" class="icon-score"></i> ƒêi·ªÉm s·ªë</th>
        <th><i nz-icon nzType="clock-circle" nzTheme="outline" class="icon-time"></i> Ho√†n th√†nh l√∫c</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let result of basicTable.data">
        <td>{{ getUserUsername(result.userId) }}</td>
        <td>{{ getQuizTitle(result.quizId) }}</td>
        <td>{{ result.score }}</td>
        <td>{{ result.completedAt | date: 'medium' }}</td>
      </tr>
    </tbody>
  </nz-table>

  <div *ngIf="!isAdmin" class="no-permission-message">
    <i nz-icon nzType="stop" nzTheme="fill"></i> B·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p k·∫øt qu·∫£ b√†i ki·ªÉm tra.
  </div>
</nz-card>
