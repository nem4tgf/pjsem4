<!-- src/app/stats/stats.component.html -->
<nz-card nzTitle="üìä Th·ªëng k√™ H·ªá th·ªëng" class="stats-card">
  <div *ngIf="isAdmin; else noPermission">
    <div *ngIf="stats; else loadingData" class="stats-content">
      <div nz-row nzGutter="24">
        <!-- T·ªïng quan c√°c s·ªë l∆∞·ª£ng -->
        <div nz-col nzXs="24" nzSm="12" nzMd="8" nzLg="6">
          <nz-card nzTitle="Ng∆∞·ªùi d√πng" nzHoverable class="stat-item-card">
            <p class="stat-value"><i nz-icon nzType="user-add" nzTheme="outline" class="icon-stat"></i> {{ stats.userCount }}</p>
          </nz-card>
        </div>
        <div nz-col nzXs="24" nzSm="12" nzMd="8" nzLg="6">
          <nz-card nzTitle="T·ª´ v·ª±ng" nzHoverable class="stat-item-card">
            <p class="stat-value"><i nz-icon nzType="book" nzTheme="outline" class="icon-stat"></i> {{ stats.vocabularyCount }}</p>
          </nz-card>
        </div>
        <div nz-col nzXs="24" nzSm="12" nzMd="8" nzLg="6">
          <nz-card nzTitle="B√†i h·ªçc" nzHoverable class="stat-item-card">
            <p class="stat-value"><i nz-icon nzType="read" nzTheme="outline" class="icon-stat"></i> {{ stats.lessonCount }}</p>
          </nz-card>
        </div>
        <div nz-col nzXs="24" nzSm="12" nzMd="8" nzLg="6">
          <nz-card nzTitle="B√†i ki·ªÉm tra" nzHoverable class="stat-item-card">
            <p class="stat-value"><i nz-icon nzType="form" nzTheme="outline" class="icon-stat"></i> {{ stats.quizCount }}</p>
          </nz-card>
        </div>
        <div nz-col nzXs="24" nzSm="12" nzMd="8" nzLg="6">
          <nz-card nzTitle="C√¢u h·ªèi" nzHoverable class="stat-item-card">
            <p class="stat-value"><i nz-icon nzType="question-circle" nzTheme="outline" class="icon-stat"></i> {{ stats.questionCount }}</p>
          </nz-card>
        </div>
        <div nz-col nzXs="24" nzSm="12" nzMd="8" nzLg="6">
          <nz-card nzTitle="K·∫øt qu·∫£ Quiz" nzHoverable class="stat-item-card">
            <p class="stat-value"><i nz-icon nzType="trophy" nzTheme="outline" class="icon-stat"></i> {{ stats.quizResultCount }}</p>
          </nz-card>
        </div>
      </div>

      <nz-divider nzText="Ph√¢n ph·ªëi d·ªØ li·ªáu"></nz-divider>

      <div nz-row nzGutter="24">
        <!-- Ph√¢n ph·ªëi theo vai tr√≤ ng∆∞·ªùi d√πng -->
        <div nz-col nzXs="24" nzSm="12" nzMd="12" nzLg="6" *ngIf="stats.userRoleDistribution && getKeys(stats.userRoleDistribution).length > 0">
          <nz-card nzTitle="Vai tr√≤ ng∆∞·ªùi d√πng" nzHoverable class="distribution-card">
            <ul class="distribution-list">
              <li *ngFor="let role of getKeys(stats.userRoleDistribution)">
                <span class="distribution-label">{{ role | titlecase }}:</span>
                <span class="distribution-value">{{ stats.userRoleDistribution[role] }}</span>
              </li>
            </ul>
          </nz-card>
        </div>

        <!-- Ph√¢n ph·ªëi theo ƒë·ªô kh√≥ t·ª´ v·ª±ng -->
        <div nz-col nzXs="24" nzSm="12" nzMd="12" nzLg="6" *ngIf="stats.vocabularyDifficultyDistribution && getKeys(stats.vocabularyDifficultyDistribution).length > 0">
          <nz-card nzTitle="ƒê·ªô kh√≥ T·ª´ v·ª±ng" nzHoverable class="distribution-card">
            <ul class="distribution-list">
              <li *ngFor="let difficulty of getKeys(stats.vocabularyDifficultyDistribution)">
                <span class="distribution-label">{{ difficulty | titlecase }}:</span>
                <span class="distribution-value">{{ stats.vocabularyDifficultyDistribution[difficulty] }}</span>
              </li>
            </ul>
          </nz-card>
        </div>

        <!-- Ph√¢n ph·ªëi theo c·∫•p ƒë·ªô b√†i h·ªçc -->
        <div nz-col nzXs="24" nzSm="12" nzMd="12" nzLg="6" *ngIf="stats.lessonLevelDistribution && getKeys(stats.lessonLevelDistribution).length > 0">
          <nz-card nzTitle="C·∫•p ƒë·ªô B√†i h·ªçc" nzHoverable class="distribution-card">
            <ul class="distribution-list">
              <li *ngFor="let level of getKeys(stats.lessonLevelDistribution)">
                <span class="distribution-label">{{ level | titlecase }}:</span>
                <span class="distribution-value">{{ stats.lessonLevelDistribution[level] }}</span>
              </li>
            </ul>
          </nz-card>
        </div>

        <!-- Ph√¢n ph·ªëi theo k·ªπ nƒÉng b√†i h·ªçc -->
        <div nz-col nzXs="24" nzSm="12" nzMd="12" nzLg="6" *ngIf="stats.lessonSkillDistribution && getKeys(stats.lessonSkillDistribution).length > 0">
          <nz-card nzTitle="K·ªπ nƒÉng B√†i h·ªçc" nzHoverable class="distribution-card">
            <ul class="distribution-list">
              <li *ngFor="let skill of getKeys(stats.lessonSkillDistribution)">
                <span class="distribution-label">{{ skill | titlecase }}:</span>
                <span class="distribution-value">{{ stats.lessonSkillDistribution[skill] }}</span>
              </li>
            </ul>
          </nz-card>
        </div>
      </div>
    </div>
    <ng-template #loadingData>
      <div class="loading-container">
        <nz-spin nzSimple></nz-spin>
        <p>ƒêang t·∫£i d·ªØ li·ªáu th·ªëng k√™...</p>
      </div>
    </ng-template>
  </div>
  <ng-template #noPermission>
    <div class="no-permission-message">
      <p><i nz-icon nzType="stop" nzTheme="fill"></i> B·∫°n kh√¥ng c√≥ quy·ªÅn truy c·∫≠p trang th·ªëng k√™.</p>
    </div>
  </ng-template>
</nz-card>
